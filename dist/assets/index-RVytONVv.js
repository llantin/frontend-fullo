import{r as c,x as N,j as e,aH as R,y as S,A as B,z as I,aX as A,aR as M,bj as O,a as T,n as q,f as D,C as U,X as W}from"./index-D8RmveFg.js";import{c as X,a as C,u as _,o as z}from"./index.esm-DbOhfXXi.js";import{P as G}from"./PageBreadcrumb-Dw5_9Adg.js";import{C as w}from"./Card-C3khdGa0.js";import{F as J,b as y}from"./Form-BCZM8NW3.js";import{F as g}from"./FormLabel-B53mBRFw.js";import{F as m}from"./FormControl-BP6VLzH_.js";import"./ElementChildren-DUlSq7n6.js";const E=R("h4");E.displayName="DivStyledAsH4";const $=c.forwardRef(({className:r,bsPrefix:s,as:t=E,...a},o)=>(s=N(s,"alert-heading"),e.jsx(t,{ref:o,className:S(r,s),...a})));$.displayName="AlertHeading";const k=c.forwardRef(({className:r,bsPrefix:s,as:t=B,...a},o)=>(s=N(s,"alert-link"),e.jsx(t,{ref:o,className:S(r,s),...a})));k.displayName="AlertLink";const H=c.forwardRef((r,s)=>{const{bsPrefix:t,show:a=!0,closeLabel:o="Close alert",closeVariant:p,className:h,children:n,variant:j="primary",onClose:d,dismissible:x,transition:i=A,...f}=I(r,{show:"onClose"}),u=N(t,"alert"),b=M(L=>{d&&d(!1,L)}),l=i===!0?A:i,v=e.jsxs("div",{role:"alert",...l?void 0:f,ref:s,className:S(h,u,j&&`${u}-${j}`,x&&`${u}-dismissible`),children:[x&&e.jsx(O,{onClick:b,"aria-label":o,variant:p}),n]});return l?e.jsx(l,{unmountOnExit:!0,...f,ref:void 0,in:a,children:v}):a?v:null});H.displayName="Alert";const F=Object.assign(H,{Link:k,Heading:$}),P=async r=>{try{return(await T.post("/support/send",r)).data}catch(s){throw console.error("Error al enviar soporte:",s),s.response?.data||s}},ae=()=>{const r=localStorage.getItem("user"),s=r?JSON.parse(r):null,[t,a]=c.useState(""),[o,p]=c.useState(""),[h,n]=c.useState(!1),j=X().shape({subject:C().required("El asunto es obligatorio"),description:C().required("La descripción es obligatoria")}),{register:d,handleSubmit:x,formState:{errors:i},reset:f}=_({resolver:z(j)}),u=async b=>{try{const l={name:`${s.person.name} ${s.person.last_name}`,email:s.email,subject:b.subject,description:b.description},v=await P(l);console.log("✅ Soporte enviado:",v),f(),a("Tu consulta ha sido enviada con éxito"),p(""),n(!0),setTimeout(()=>n(!1),5e3)}catch(l){console.error("❌ Error al enviar soporte:",l),p("Hubo un problema al enviar tu consulta"),a(""),n(!0),setTimeout(()=>n(!1),5e3)}};return e.jsxs(q,{fluid:!0,children:[e.jsx(G,{title:"Soporte y asistencia"}),e.jsx("h5",{children:"Puedes enviar tu consulta al administrador del sistema. Se encargará de resolverla lo antes posible y te contactará por correo o WhatsApp."}),e.jsx(w,{className:"mb-3",children:e.jsxs(w.Body,{children:[t&&e.jsx(F,{variant:"success",show:h,onClose:()=>n(!1),dismissible:!0,fade:!0,children:t}),o&&e.jsx(F,{variant:"danger",show:h,onClose:()=>n(!1),dismissible:!0,fade:!0,children:o}),e.jsxs(J,{onSubmit:x(u),children:[e.jsx(D,{children:e.jsx(U,{sm:12,children:e.jsxs(y,{className:"mb-3",children:[e.jsx(g,{children:"Nombre de usuario"}),e.jsx(m,{type:"text",value:`${s.person.name} ${s.person.last_name}`,readOnly:!0})]})})}),e.jsxs(y,{className:"mb-3",children:[e.jsx(g,{children:"Asunto"}),e.jsx(m,{type:"text",placeholder:"Asunto de la consulta",...d("subject"),isInvalid:!!i.subject}),e.jsx(m.Feedback,{type:"invalid",children:i.subject?.message})]}),e.jsxs(y,{className:"mb-3",children:[e.jsx(g,{children:"Descripción de la consulta"}),e.jsx(m,{as:"textarea",rows:4,placeholder:"Escribe tu consulta aquí...",...d("description"),isInvalid:!!i.description}),e.jsx(m.Feedback,{type:"invalid",children:i.description?.message})]}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx(W,{type:"submit",variant:"primary",children:"Enviar soporte"})})]})]})})]})};export{ae as default};
